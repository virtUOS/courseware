(function(e){function t(t){for(var s,o,a=t[0],l=t[1],c=t[2],u=0,m=[];u<a.length;u++)o=a[u],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&m.push(r[o][0]),r[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);d&&d(t);while(m.length)m.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],s=!0,a=1;a<i.length;a++){var l=i[a];0!==r[l]&&(s=!1)}s&&(n.splice(t--,1),e=o(o.s=i[0]))}return e}var s={},r={index:0},n=[];function o(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=s,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(i,s,function(t){return e[t]}.bind(null,s));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="../../../plugins_packages/virtUOS/Courseware/views/block_manager/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var d=l;n.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("b635")},b635:function(e,t,i){"use strict";i.r(t);i("14c6"),i("08c1"),i("4842"),i("d9fc");var s=i("2b0e"),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"cw-blockmanager-content"}},[i("div",{staticClass:"cw-blockmanager-wrapper"},[i("div",{staticClass:"cw-blockmanager-title"},[i("p",[e._v(e._s(this.courseware.title))]),i("div",{staticClass:"cw-blockmanager-title-loading"},[e.storeLock?i("spring-spinner",{attrs:{"animation-duration":1e3,size:30,color:"#28497c"}}):e._e()],1),i("ActionMenuItem",{attrs:{buttons:["add-child"],element:this.courseware},on:{"add-child":e.addChild}})],1),i("draggable",e._b({staticClass:"chapter-list",attrs:{tag:"ul",list:e.chapters,group:{name:"chapters"},"ghost-class":"ghost",handle:".chapter-handle"},on:{sort:e.sortChapters}},"draggable",e.storeLock?{disabled:!0}:{disabled:!1,animation:200},!1),e._l(this.chapters,(function(t){return i("ChapterItem",{key:t.id,attrs:{element:t,importContent:!1,remoteContent:!1,storeLock:e.storeLock},on:{listUpdate:e.updateList,"remove-chapter":e.removeChapter,isRemote:e.isRemoteAction,isImport:e.isImportAction}})})),1)],1),i("div",{staticClass:"cw-blockmanager-wrapper",attrs:{id:"cw-action-wrapper"}},[i("div",{staticClass:"cw-blockmanager-title",attrs:{id:"cw-import-title"}},[i("p",[e._v(e._s(e.actionTitle))])]),e.fileError?i("div",{staticClass:"messagebox messagebox_error"},[e._v(" "+e._s(e.$t("message.invalidArchiveFile"))+" ")]):e._e(),!e.showRemoteCourseware||e.remoteCourseware||e.loading?e._e():i("div",{attrs:{id:"user-course-list"}},[i("ul",{staticClass:"semester-list"},[e._l(this.remoteCourses,(function(t,s){return i("SemesterItem",{key:s,attrs:{courses:t,semester_name:s},on:{"course-selected":e.getRemoteCourse}})})),0==this.remoteCourses.length?i("div",{staticClass:"messagebox messagebox_info"},[e._v(" "+e._s(e.$t("message.noRemoteCoursesAvailable"))+" ")]):e._e()],2)]),e.showRemoteCourseware&&e.remoteCourseware?i("div",{staticClass:"cw-remote-courseware"},[i("draggable",e._b({staticClass:"chapter-list chapter-list-import",attrs:{tag:"ul",list:this.remoteCourseware.children,group:{name:"chapters",pull:"clone",put:!1},"ghost-class":"ghost",handle:".chapter-handle"}},"draggable",e.storeLock?{disabled:!0}:{disabled:!1,animation:200,sort:!1},!1),e._l(this.remoteCourseware.children,(function(t){return i("ChapterItem",{key:t.id,attrs:{element:t,importContent:!0,remoteContent:!0,storeLock:e.storeLock}})})),1)],1):e._e(),e.showImportCourseware&&e.importCourseware?i("div",{attrs:{id:"cw-import-lists"}},[i("draggable",e._b({staticClass:"chapter-list chapter-list-import",attrs:{tag:"ul",list:this.importCourseware.chapters,group:{name:"chapters",pull:"clone",put:!1},"ghost-class":"ghost",handle:".chapter-handle"}},"draggable",e.storeLock?{disabled:!0}:{disabled:!1,animation:200,sort:!1},!1),e._l(this.importCourseware.chapters,(function(t){return i("ChapterItem",{key:t.id,attrs:{element:t,importContent:!0,remoteContent:!1,storeLock:e.storeLock}})})),1)],1):e._e(),e.showExportCourseware?i("div"):e._e(),e.showRemoteCourseware||e.showImportCourseware||e.showExportCourseware?e._e():i("ul",{attrs:{id:"cw-action-selection"}},[i("li",[i("label",{staticClass:"cw-action-menu-button",attrs:{for:"cw-file-upload-import",id:"cw-file-upload-import-label",title:e.$t("message.importFromArchiveExplain")}},[i("input",{staticClass:"cw-file-upload-import",attrs:{type:"file",name:"cw-file-upload-import",id:"cw-file-upload-import",accept:".zip"},on:{change:e.setImport}}),i("p",[e._v(e._s(e.$t("message.importFromArchiveButton")))])])]),i("li",[i("a",{attrs:{href:e.coursewareImportURL}},[i("div",{staticClass:"cw-action-menu-button",attrs:{id:"cw-import-link",title:e.$t("message.importExplain")}},[i("p",[e._v(e._s(e.$t("message.importButton")))])])])]),i("li",[i("div",{staticClass:"cw-action-menu-button",attrs:{id:"cw-import-from-course",title:e.$t("message.importFromCourseExplain")},on:{click:e.importFromCourse}},[i("p",[e._v(e._s(e.courseImportText))])])]),i("li",[i("a",{attrs:{href:e.coursewareExportURL}},[i("div",{staticClass:"cw-action-menu-button",attrs:{id:"cw-export-download",title:e.$t("message.exportExplain")}},[i("p",[e._v(e._s(e.$t("message.exportButton")))])])])]),i("li",[i("a",{attrs:{href:e.coursewareExportHtmlURL}},[i("div",{staticClass:"cw-action-menu-button",attrs:{id:"cw-export-html-download",title:e.$t("message.exportHtmlExplain")}},[i("p",[e._v(e._s(e.$t("message.exportHtmlButton")))])])])])]),(e.showRemoteCourseware||e.showImportCourseware)&&e.loading?i("div",[i("spring-spinner",{staticClass:"cw-action-loading",attrs:{"animation-duration":3e3,size:65,color:"#28497c"}})],1):e._e(),i("div",{staticClass:"cw-action-button-wrapper"},[(e.showRemoteCourseware||e.showImportCourseware||e.showExportCourseware)&&!e.loading?i("button",{staticClass:"button",attrs:{id:"cw-reset-action-menu"},on:{click:e.resetActionMenu}},[e._v(" "+e._s(e.$t("message.tasksBackButton"))+" ")]):e._e(),!e.showImportCourseware||e.fileError||e.loading?e._e():i("button",{staticClass:"button",attrs:{id:"cw-import"},on:{click:e.importCompleteArchive}},[e._v(" "+e._s(e.$t("message.importingButton"))+" ")]),e.showExportCourseware?i("a",{attrs:{href:e.coursewareExportURL}},[i("button",{staticClass:"button",attrs:{id:"cw-export"}},[e._v(" "+e._s(e.$t("message.exportingButton"))+" ")])]):e._e(),i("div",{staticStyle:{clear:"both"}})])]),i("div",{staticClass:"cw-blockmanager-wrapper"},[i("div",{staticClass:"cw-blockmanager-title cw-blockmanager-help",class:{unfolded:e.helpUnfolded},on:{click:function(t){e.helpUnfolded=!e.helpUnfolded}}},[i("p",[e._v(e._s(e.$t("message.help")))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.helpUnfolded,expression:"helpUnfolded"}],staticClass:"helpboxes"},[i("HelpBox",{attrs:{title:e.$t("message.help_about_title"),content:e.$t("message.help_about_content")}}),i("HelpBox",{attrs:{title:e.$t("message.help_sort_title"),content:e.$t("message.help_sort_content")}}),i("HelpBox",{attrs:{title:e.$t("message.help_approval_title"),content:e.$t("message.help_approval_content")}}),i("HelpBox",{attrs:{title:e.$t("message.help_add_and_delete_title"),content:e.$t("message.help_add_and_delete_content")}}),i("HelpBox",{attrs:{title:e.$t("message.help_import_title"),content:e.$t("message.help_import_content")}}),i("HelpBox",{attrs:{title:e.$t("message.help_remote_import_title"),content:e.$t("message.help_remote_import_content")}}),i("HelpBox",{attrs:{title:e.$t("message.help_export_title"),content:e.$t("message.help_export_content")}}),i("HelpBox",{attrs:{title:e.$t("message.help_html_export_title"),content:e.$t("message.help_html_export_content")}})],1)]),e.errorOccurred.length>0?i("div",{staticClass:"cw-blockmanager-wrapper",attrs:{id:"errorbox"}},[i("div",{staticClass:"cw-blockmanager-title",attrs:{id:"cw-error-title"}},[i("p",[e._v(e._s(e.$t("message.messages")))])]),i("ul",e._l(e.errorOccurred,(function(t,s){return i("li",{key:s},[e._v(e._s(t.date)+" | "+e._s(t.text)+" ")])})),0)]):e._e()])},n=[],o=(i("e285"),i("c880"),i("0c1f"),i("2e73"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",{staticClass:"chapter-item",class:{"chapter-item-import":e.importContent,"chapter-item-remote":e.remoteContent},attrs:{"data-id":e.id}},[i("div",{staticClass:"chapter-description chapter-handle",class:{"full-width":e.importContent||e.remoteContent,unfolded:e.unfolded},on:{click:e.toggleContent}},[i("p",{staticClass:"chapter-title",attrs:{title:e.title}},[e._v(" "+e._s(e.shortTitle)+" ")]),i("p",{staticClass:"header-info-wrapper"},[i("span",{class:{"unpublished-info":!e.isPublished&&(e.publication_date||e.withdraw_date),"published-info":e.isPublished&&(e.publication_date||e.withdraw_date)}},[e._v(" "+e._s(e.$t("message.chapter"))+" ")]),!e.publication_date||this.importContent||this.remoteContent?e._e():i("span",{class:{"unpublished-info":!e.isPublished,"published-info":e.isPublished}},[e._v("| "+e._s(e.$t("message.visibleFrom"))+": "+e._s(e.publication_date_readable))]),!e.withdraw_date||this.importContent||this.remoteContent?e._e():i("span",{class:{"unpublished-info":!e.isPublished,"published-info":e.isPublished}},[e._v(" | "+e._s(e.$t("message.invisibleFrom"))+": "+e._s(e.withdraw_date_readable))])])]),this.importContent||this.remoteContent?e._e():i("ActionMenuItem",{class:{unfolded:e.unfolded},attrs:{buttons:["edit","remove","groups","users","add-child"],element:this.element},on:{edit:e.editElement,remove:e.removeElement,"add-child":e.addChild}}),e.unfolded?i("draggable",e._b({staticClass:"subchapter-list",class:{"subchapter-list-import":e.importContent},attrs:{tag:"ul",list:e.subchapters,group:e.draggableGroup,"ghost-class":"ghost",handle:".subchapter-handle"},on:{sort:e.sortSubchapters}},"draggable",e.dragOptions,!1),[e._l(e.subchapters,(function(t){return i("SubchapterItem",{key:t.id,attrs:{element:t,importContent:e.importContent,remoteContent:e.remoteContent,storeLock:e.storeLock},on:{listUpdate:e.updateList,"remove-subchapter":e.removeSubchapter,isRemote:e.isRemoteAction,isImport:e.isImportAction}})})),0==e.subchapters.length?i("p",[e._v(" "+e._s(e.$t("message.emptyChapter"))+". "),e.importContent?e._e():i("span",[e._v(e._s(e.$t("message.emptyChapterInfo"))+".")])]):e._e()],2):e._e()],1)}),a=[],l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",{staticClass:"subchapter-item",class:{"subchapter-item-import":e.importContent,"subchapter-item-remote":e.remoteContent},attrs:{"data-id":e.id}},[i("div",{staticClass:"subchapter-description subchapter-handle",class:{"full-width":e.importContent||e.remoteContent,unfolded:e.unfolded},on:{click:e.toggleContent}},[i("p",{staticClass:"subchapter-title",attrs:{title:e.title}},[e._v(e._s(e.shortTitle))]),i("p",{staticClass:"header-info-wrapper"},[i("span",{class:{"unpublished-info":!e.isPublished&&(e.publication_date||e.withdraw_date),"published-info":e.isPublished&&(e.publication_date||e.withdraw_date)}},[e._v(" "+e._s(e.$t("message.subchapter"))+" ")]),!e.publication_date||this.importContent||this.remoteContent?e._e():i("span",{class:{"unpublished-info":!e.isPublished,"published-info":e.isPublished}},[e._v(" | "+e._s(e.$t("message.visibleFrom"))+": "+e._s(e.publication_date_readable))]),!e.withdraw_date||this.importContent||this.remoteContent?e._e():i("span",{class:{"unpublished-info":!e.isPublished,"published-info":e.isPublished}},[e._v(" | "+e._s(e.$t("message.invisibleFrom"))+": "+e._s(e.withdraw_date_readable))])])]),this.importContent||this.remoteContent?e._e():i("ActionMenuItem",{class:{unfolded:e.unfolded},attrs:{buttons:["edit","remove","groups","users","add-child"],element:this.element},on:{edit:e.editElement,remove:e.removeElement,"add-child":e.addChild}}),e.unfolded?i("draggable",e._b({staticClass:"section-list",class:{"section-list-import":e.importContent},attrs:{tag:"ul",list:e.sections,group:e.draggableGroup,"ghost-class":"ghost",handle:".section-handle"},on:{sort:e.sortSections}},"draggable",e.dragOptions,!1),[e._l(e.sections,(function(t){return i("SectionItem",{key:t.id,attrs:{element:t,importContent:e.importContent,remoteContent:e.remoteContent,storeLock:e.storeLock},on:{listUpdate:e.updateList,"remove-section":e.removeSection,isRemote:e.isRemoteAction,isImport:e.isImportAction}})})),0==e.sections.length?i("p",[e._v(" "+e._s(e.$t("message.emptySubchapter"))+". "),e.importContent?e._e():i("span",[e._v(e._s(e.$t("message.emptySubchapterInfo"))+".")])]):e._e()],2):e._e()],1)},c=[],d=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",{staticClass:"section-item",class:{"section-item-import":e.importContent,"section-item-remote":e.remoteContent},attrs:{"data-id":e.id}},[i("div",{staticClass:"section-description section-handle",class:{"full-width":e.importContent||e.remoteContent,unfolded:e.unfolded},on:{click:e.toggleContent}},[i("p",{staticClass:"section-title",attrs:{title:e.title}},[e._v(e._s(e.shortTitle))]),i("p",{staticClass:"header-info-wrapper"},[e._v(e._s(e.$t("message.section")))])]),this.importContent||this.remoteContent?e._e():i("ActionMenuItem",{class:{unfolded:e.unfolded},attrs:{buttons:["groups","users","edit","remove"],element:this.element},on:{edit:e.editSection,remove:e.removeElement}}),e.unfolded?i("draggable",e._b({staticClass:"block-list",class:{"block-list-import":e.importContent},attrs:{tag:"ul",list:e.blocks,group:e.draggableGroup,"ghost-class":"ghost",handle:".block-handle"},on:{sort:e.sortBlocks}},"draggable",e.dragOptions,!1),[e._l(e.blocks,(function(t){return i("BlockItem",{key:t.id,attrs:{block:t,importContent:e.importContent,remoteContent:e.remoteContent},on:{"remove-block":e.removeBlock,isRemote:e.isRemoteAction}})})),0==e.blocks.length?i("p",[e._v(" "+e._s(e.$t("message.emptySection"))+". "),e.importContent?e._e():i("span",[e._v(e._s(e.$t("message.emptySectionInfo"))+".")])]):e._e()],2):e._e()],1)},u=[],m=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",{staticClass:"block-item",class:{element_hidden:!e.block.isPublished&&!this.importContent&&!this.remoteContent,"block-item-import":e.importContent,"block-item-remote":e.remoteContent},attrs:{"data-id":e.id}},[i("div",{staticClass:"block-description block-handle",class:{element_hidden:!e.block.isPublished&&!this.importContent&&!this.remoteContent,unfolded:e.unfolded},on:{click:e.toggleContent}},[i("span",{class:["block-icon cw-block-icon-"+e.block.type]}),e._v(" "+e._s(e.block.readable_name)+" ")]),this.importContent||this.remoteContent?e._e():i("ActionMenuItem",{attrs:{buttons:["remove"],element:this.block},on:{remove:e.removeElement}}),e.unfolded?i("ul",{staticClass:"block-preview",class:{"block-preview-import":e.importContent}},[i("li",{staticClass:"block-content-preview",domProps:{innerHTML:e._s(e.preview)}})]):e._e()],1)},h=[],p=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"strucutal-element-menu-wrapper"},[i("nav",{ref:"actionMenu",staticClass:"action-menu bymousedown strucutal-element-menu"},[e._m(0),i("div",{staticClass:"action-menu-content"},[i("div",{staticClass:"action-menu-title"},[e._v(" "+e._s(e.$t("message.actions"))+" ")]),i("ul",{staticClass:"action-menu-list"},[this.users_button?i("li",{staticClass:"action-menu-item"},[i("a",{staticClass:"set-users",attrs:{href:"#"},on:{click:function(t){e.setStudentsPermissionsDialogVisible=!0,e.$refs.actionMenu.classList.remove("active")}}},[e._v(" "+e._s(e.$t("message.setStudentsPermissions"))+" ")])]):e._e(),this.groups_button?i("li",{staticClass:"action-menu-item"},[i("a",{staticClass:"set-groups",attrs:{href:"#"},on:{click:function(t){e.setGroupsPermissionsDialogVisible=!0,e.$refs.actionMenu.classList.remove("active")}}},[e._v(" "+e._s(e.$t("message.setGroupsPermissions"))+" ")])]):e._e(),this.edit_button?i("li",{staticClass:"action-menu-item"},[i("a",{staticClass:"edit-element",attrs:{href:"#"},on:{click:function(t){e.editDialogVisible=!0,e.$refs.actionMenu.classList.remove("active")}}},[e._v(" "+e._s(e.$t("message.editElement"))+" ")])]):e._e(),this.remove_button?i("li",{staticClass:"action-menu-item"},[i("a",{staticClass:"remove-element",attrs:{href:"#"},on:{click:function(t){e.removeDialogVisible=!0,e.$refs.actionMenu.classList.remove("active")}}},[e._v(" "+e._s(e.$t("message.deleteElement"))+" ")])]):e._e(),this.add_child_button?i("li",{staticClass:"action-menu-item"},[i("a",{staticClass:"add-child-element",attrs:{href:"#"},on:{click:function(t){e.addChildDialogVisible=!0,e.$refs.actionMenu.classList.remove("active")}}},[e._v(" "+e._s(e.$t("message.addSubelement"))+" ")])]):e._e()])])]),i("StudentsPermissionsDialog",{attrs:{DialogVisible:this.setStudentsPermissionsDialogVisible,element:this.element},on:{close:function(t){e.setStudentsPermissionsDialogVisible=!1},set:e.setStudentsPermissionsAction}}),i("GroupsPermissionsDialog",{attrs:{DialogVisible:this.setGroupsPermissionsDialogVisible,element:this.element},on:{close:function(t){e.setGroupsPermissionsDialogVisible=!1},set:e.setGroupsPermissionsAction}}),i("EditDialog",{attrs:{DialogVisible:this.editDialogVisible,element:this.element},on:{close:function(t){e.editDialogVisible=!1},edit:e.editDialogAction}}),i("RemoveDialog",{attrs:{DialogVisible:this.removeDialogVisible,element:this.element},on:{close:function(t){e.removeDialogVisible=!1},remove:function(t){return e.$emit("remove")}}}),i("AddChildDialog",{attrs:{DialogVisible:this.addChildDialogVisible,element:this.element},on:{close:function(t){e.addChildDialogVisible=!1},"add-child":e.addChildDialogAction}})],1)},g=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a",{staticClass:"action-menu-icon",attrs:{title:"Aktionen",href:"#"}},[i("div"),i("div"),i("div")])}],b=function(){var e=this,t=e.$createElement,i=e._self._c||t;return this.visible?i("div",{staticClass:"cw-dialog"},[i("transition",{attrs:{name:"modal-fade"}},[i("div",{staticClass:"modal-backdrop"},[i("div",{staticClass:"modal alert",attrs:{role:"dialog"}},[i("header",{staticClass:"modal-header"},[e._t("header",[e._v(" "+e._s(e.$t("message.deleteDialogTitle",[this.title]))+" "),i("span",{staticClass:"modal-close-button",on:{click:e.close}})])],2),i("section",{staticClass:"modal-body"},[this.currentElement.isStrucutalElement?i("p",[e._v(" "+e._s(e.$t("message.deleteDialogQuestionElement"))+"? ")]):e._e(),this.currentElement.isBlock?i("p",[e._v(e._s(e.$t("message.deleteDialogQuestionBlock"))+"?")]):e._e()]),i("footer",{staticClass:"modal-footer"},[e._t("footer",[e.deleting?i("button",{staticClass:"button modal-progress",attrs:{type:"button"}},[i("spring-spinner",{staticClass:"modal-progress-spinner",attrs:{"animation-duration":3e3,size:14,color:"#28497c"}})],1):i("button",{staticClass:"button accept",attrs:{type:"button"},on:{click:e.remove}},[e._v(" "+e._s(e.$t("message.ButtonLabelYes"))+" ")]),i("button",{staticClass:"button cancel",class:{"button-inactive":e.deleting},attrs:{type:"button"},on:{click:e.close}},[e._v(" "+e._s(e.$t("message.ButtonLabelNo"))+" ")])])],2)])])])],1):e._e()},_=[],f=i("4583"),v={name:"RemoveDialog",components:{SpringSpinner:f["a"]},props:{DialogVisible:Boolean,element:Object},data:function(){return{visible:this.DialogVisible,title:"",currentElement:this.element,deleting:!1}},mounted:function(){this.currentElement&&(this.currentElement.isBlock&&(this.title=this.currentElement.readable_name),this.currentElement.isStrucutalElement&&(this.title=this.currentElement.title))},methods:{close:function(){this.deleting||this.$emit("close")},remove:function(){var e={},t=this;e.id=this.currentElement.id,this.deleting=!0,$.ajax({type:"DELETE",url:"../blocks/"+e.id,contentType:"application/json",data:e,success:function(){t.$emit("remove"),t.deleting=!1,t.$emit("close")},error:function(){console.log("can not remove node!"),t.deleting=!1,t.$emit("close")}})}},watch:{DialogVisible:function(){this.visible=this.DialogVisible}}},w=v,C=i("2877"),k=Object(C["a"])(w,b,_,!1,null,null,null),y=k.exports,A=function(){var e=this,t=e.$createElement,i=e._self._c||t;return this.visible?i("div",{staticClass:"cw-dialog"},[i("transition",{attrs:{name:"modal-fade"}},[i("div",{staticClass:"modal-backdrop"},[i("div",{staticClass:"modal",attrs:{role:"dialog"}},[i("header",{staticClass:"modal-header"},[e._t("header",[e._v(" "+e._s(e.$t("message.editDialogTitle",[this.title]))+" "),i("span",{staticClass:"modal-close-button",on:{click:e.close}})])],2),i("section",{staticClass:"modal-body"},[i("label",{attrs:{for:"editDialogElementTitle"}},[e._v(e._s(e.$t("message.title"))+":")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],ref:"editDialogElementTitle",attrs:{type:"text",name:"editDialogElementTitle"},domProps:{value:e.title},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.edit(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.close(t)}],input:function(t){t.target.composing||(e.title=t.target.value)}}}),i("br"),e.isChapter?i("div",[i("label",{attrs:{for:"publication_date"}},[e._v(e._s(e.$t("message.visibleFrom"))+":")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.publicationDate,expression:"publicationDate"}],attrs:{type:"date",name:"publication_date",max:e.maxPublicationDate},domProps:{value:e.publicationDate},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.edit(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.close(t)}],input:function(t){t.target.composing||(e.publicationDate=t.target.value)}}}),i("br"),i("label",{attrs:{for:"withdraw_date"}},[e._v(e._s(e.$t("message.invisibleFrom"))+":")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.withdrawDate,expression:"withdrawDate"}],attrs:{type:"date",name:"withdraw_date",min:e.minWithdrawDate},domProps:{value:e.withdrawDate},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.edit(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.close(t)}],input:function(t){t.target.composing||(e.withdrawDate=t.target.value)}}})]):e._e()]),i("footer",{staticClass:"modal-footer"},[e._t("footer",[i("button",{staticClass:"button accept",attrs:{type:"button"},on:{click:e.edit}},[e._v(" "+e._s(e.$t("message.ButtonLabelSave"))+" ")]),i("button",{staticClass:"button cancel",attrs:{type:"button"},on:{click:e.close}},[e._v(" "+e._s(e.$t("message.ButtonLabelClose"))+" ")])])],2)])])])],1):e._e()},E=[],x=(i("ae66"),{name:"EditDialog",props:{DialogVisible:Boolean,element:Object},data:function(){return{visible:this.DialogVisible,title:"",currentElement:this.element,isChapter:!1,publicationDate:null,maxPublicationDate:"",withdrawDate:null,minWithdrawDate:""}},mounted:function(){this.currentElement&&(this.title=this.currentElement.title,"Chapter"!=this.currentElement.type&&"Subchapter"!=this.currentElement.type||(this.isChapter=!0,this.currentElement.publication_date&&(this.publicationDate=this.convertTimestampToDate(this.currentElement.publication_date)),this.currentElement.withdraw_date&&(this.withdrawDate=this.convertTimestampToDate(this.currentElement.withdraw_date))))},methods:{close:function(){this.$emit("close")},edit:function(){var e=this,t={};if(t.id=this.element.id,t.title=this.title,this.isChapter){var i=/(\d{4})-(\d{2})-(\d{2})/;if(this.publicationDate&&(t.publication_date=new Date(this.publicationDate.replace(i,"$2,$3,$1")).getTime()/1e3,t.publication_date_readable=this.publicationDate.replace(i,"$3.$2.$1")),this.withdrawDate&&(t.withdraw_date=new Date(this.withdrawDate.replace(i,"$2,$3,$1")).getTime()/1e3,t.withdraw_date_readable=this.withdrawDate.replace(i,"$3.$2.$1")),t.withdraw_date<=t.publication_date)return;t.isPublished=this.isPublished(this.publicationDate,this.withdrawDate)}$.ajax({type:"PUT",url:"../blocks/"+t.id,contentType:"application/json",data:JSON.stringify(t),success:function(){e.$emit("edit",t),e.$emit("close")},error:function(){console.log("can not remove node!"),e.$emit("close")}})},convertTimestampToDate:function(e){var t=new Date(e);return t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)},isPublished:function(e,t){var i=new Date;return(new Date(e)<i||null==e)&&(new Date(t)>i||null==t)}},watch:{DialogVisible:function(){var e=this;this.visible=this.DialogVisible,this.$nextTick((function(){e.$refs.editDialogElementTitle&&e.$refs.editDialogElementTitle.focus()}))},publicationDate:function(){this.minWithdrawDate=this.convertTimestampToDate(this.publicationDate)},withdrawDate:function(){this.maxPublicationDate=this.convertTimestampToDate(this.withdrawDate)}}}),D=x,S=Object(C["a"])(D,A,E,!1,null,null,null),O=S.exports,B=function(){var e=this,t=e.$createElement,i=e._self._c||t;return this.visible?i("div",{staticClass:"cw-dialog"},[i("transition",{attrs:{name:"modal-fade"}},[i("div",{staticClass:"modal-backdrop"},[i("div",{staticClass:"modal",attrs:{role:"dialog"}},[i("header",{staticClass:"modal-header"},[e._t("header",[e._v(" "+e._s(e.$t("message.addDialogTitle"))+" "),i("span",{staticClass:"modal-close-button",on:{click:e.close}})])],2),i("section",{staticClass:"modal-body"},[i("label",{attrs:{for:"editDialogElementTitle"}},[e._v(e._s(e.$t("message.title"))+":")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],ref:"editDialogElementTitle",attrs:{type:"text",name:"editDialogElementTitle"},domProps:{value:e.title},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.edit(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.close(t)}],input:function(t){t.target.composing||(e.title=t.target.value)}}})]),i("footer",{staticClass:"modal-footer"},[e._t("footer",[i("button",{staticClass:"button accept",attrs:{type:"button"},on:{click:e.edit}},[e._v(" "+e._s(e.$t("message.ButtonLabelSave"))+" ")]),i("button",{staticClass:"button cancel",attrs:{type:"button"},on:{click:e.close}},[e._v(" "+e._s(e.$t("message.ButtonLabelClose"))+" ")])])],2)])])])],1):e._e()},L=[],I=i("bc3a"),P=i.n(I),T={name:"AddChildDialog",props:{DialogVisible:Boolean,element:Object},data:function(){return{visible:this.DialogVisible,type:this.element.childType,title:"",currentElement:this.element}},mounted:function(){},methods:{close:function(){this.$emit("close"),this.title=""},edit:function(){var e=this;""==this.title&&(this.title="new "+this.type),P.a.post("add_structure",{parent:e.element.id,title:e.title,type:e.type,cid:COURSEWARE.config.cid}).then((function(t){e.$emit("add-child",t.data),e.close()})).catch((function(t){console.log("there was an error: "+t.response),e.close()}))}},watch:{DialogVisible:function(){var e=this;this.visible=this.DialogVisible,this.$nextTick((function(){e.$refs.editDialogElementTitle&&e.$refs.editDialogElementTitle.focus()}))}}},R=T,U=Object(C["a"])(R,B,L,!1,null,null,null),j=U.exports,V=function(){var e=this,t=e.$createElement,i=e._self._c||t;return this.visible?i("div",{staticClass:"cw-dialog"},[i("transition",{attrs:{name:"modal-fade"}},[i("div",{staticClass:"modal-backdrop"},[i("div",{staticClass:"modal cw-permission-modal",attrs:{role:"dialog"}},[i("header",{staticClass:"modal-header"},[e._t("header",[e._v(" "+e._s(e.$t("message.setStudentsPermissions"))+" "),i("span",{staticClass:"modal-close-button",on:{click:e.close}})])],2),i("section",{staticClass:"modal-body"},[i("label",{staticClass:"students-permissions-new-users-label"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.settings.defaultRead,expression:"settings.defaultRead"}],staticClass:"default",attrs:{type:"checkbox",value:"read"},domProps:{checked:Array.isArray(e.settings.defaultRead)?e._i(e.settings.defaultRead,"read")>-1:e.settings.defaultRead},on:{change:function(t){var i=e.settings.defaultRead,s=t.target,r=!!s.checked;if(Array.isArray(i)){var n="read",o=e._i(i,n);s.checked?o<0&&e.$set(e.settings,"defaultRead",i.concat([n])):o>-1&&e.$set(e.settings,"defaultRead",i.slice(0,o).concat(i.slice(o+1)))}else e.$set(e.settings,"defaultRead",r)}}}),e._v(" "+e._s(e.$t("message.newUserReadPerms"))+" ")]),e.autor_members.length?i("table",{staticClass:"default students-permissions-list"},[i("caption",[e._v(" "+e._s(this.settings.caption_autor)+" ")]),i("colgroup",[i("col",{attrs:{width:"20%"}}),i("col",{attrs:{width:"35%"}}),i("col",{attrs:{width:"45%"}})]),i("thead",[i("tr",[i("th",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.toggled.autor.read,expression:"toggled.autor.read"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.toggled.autor.read)?e._i(e.toggled.autor.read,null)>-1:e.toggled.autor.read},on:{change:[function(t){var i=e.toggled.autor.read,s=t.target,r=!!s.checked;if(Array.isArray(i)){var n=null,o=e._i(i,n);s.checked?o<0&&e.$set(e.toggled.autor,"read",i.concat([n])):o>-1&&e.$set(e.toggled.autor,"read",i.slice(0,o).concat(i.slice(o+1)))}else e.$set(e.toggled.autor,"read",r)},function(t){return e.toggleAll("autor","read")}]}}),e._v(" "+e._s(e.$t("message.readPerms"))+" ")]),i("th",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.toggled.autor.write,expression:"toggled.autor.write"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.toggled.autor.write)?e._i(e.toggled.autor.write,null)>-1:e.toggled.autor.write},on:{change:[function(t){var i=e.toggled.autor.write,s=t.target,r=!!s.checked;if(Array.isArray(i)){var n=null,o=e._i(i,n);s.checked?o<0&&e.$set(e.toggled.autor,"write",i.concat([n])):o>-1&&e.$set(e.toggled.autor,"write",i.slice(0,o).concat(i.slice(o+1)))}else e.$set(e.toggled.autor,"write",r)},function(t){return e.toggleAll("autor","write")}]}}),e._v(" "+e._s(e.$t("message.readWritePerms"))+" ")]),i("th",[e._v(e._s(e.$t("message.name")))])])]),i("tbody",e._l(e.autor_members,(function(t){return i("tr",{key:t.user_id},[i("td",{staticClass:"perm"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.user_perms[t.user_id],expression:"user_perms[user.user_id]"}],attrs:{type:"checkbox",id:t.user_id+"_read","true-value":"read","false-value":"none"},domProps:{checked:Array.isArray(e.user_perms[t.user_id])?e._i(e.user_perms[t.user_id],null)>-1:e._q(e.user_perms[t.user_id],"read")},on:{change:[function(i){var s=e.user_perms[t.user_id],r=i.target,n=r.checked?"read":"none";if(Array.isArray(s)){var o=null,a=e._i(s,o);r.checked?a<0&&e.$set(e.user_perms,t.user_id,s.concat([o])):a>-1&&e.$set(e.user_perms,t.user_id,s.slice(0,a).concat(s.slice(a+1)))}else e.$set(e.user_perms,t.user_id,n)},e.updateToggleStatus]}})]),i("td",{staticClass:"perm"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.user_perms[t.user_id],expression:"user_perms[user.user_id]"}],attrs:{type:"checkbox","true-value":"write","false-value":"none"},domProps:{checked:Array.isArray(e.user_perms[t.user_id])?e._i(e.user_perms[t.user_id],null)>-1:e._q(e.user_perms[t.user_id],"write")},on:{change:[function(i){var s=e.user_perms[t.user_id],r=i.target,n=r.checked?"write":"none";if(Array.isArray(s)){var o=null,a=e._i(s,o);r.checked?a<0&&e.$set(e.user_perms,t.user_id,s.concat([o])):a>-1&&e.$set(e.user_perms,t.user_id,s.slice(0,a).concat(s.slice(a+1)))}else e.$set(e.user_perms,t.user_id,n)},e.updateToggleStatus]}})]),i("td",[i("label",{attrs:{for:t.user_id+"_read"}},[e._v(" "+e._s(t.firstname)+" "+e._s(t.lastname)+" "),i("i",[e._v(e._s(t.username))])])])])})),0)]):e._e(),e.user_members.length?i("table",{staticClass:"default students-permissions-list"},[i("caption",[e._v(" "+e._s(this.settings.caption_user)+" ")]),i("colgroup",[i("col",{attrs:{width:"15%"}}),i("col",{attrs:{width:"30%"}}),i("col",{attrs:{width:"55%"}})]),i("thead",[i("th",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.toggled.user.read,expression:"toggled.user.read"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.toggled.user.read)?e._i(e.toggled.user.read,null)>-1:e.toggled.user.read},on:{change:[function(t){var i=e.toggled.user.read,s=t.target,r=!!s.checked;if(Array.isArray(i)){var n=null,o=e._i(i,n);s.checked?o<0&&e.$set(e.toggled.user,"read",i.concat([n])):o>-1&&e.$set(e.toggled.user,"read",i.slice(0,o).concat(i.slice(o+1)))}else e.$set(e.toggled.user,"read",r)},function(t){return e.toggleAll("user","read")}]}}),e._v(" "+e._s(e.$t("message.readPerms"))+" ")]),i("th"),i("th")]),i("tbody",e._l(e.user_members,(function(t){return i("tr",{key:t.user_id},[i("td",{staticClass:"perm"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.user_perms[t.user_id],expression:"user_perms[user.user_id]"}],attrs:{type:"checkbox",id:t.user_id+"_read","true-value":"read","false-value":"none"},domProps:{checked:Array.isArray(e.user_perms[t.user_id])?e._i(e.user_perms[t.user_id],null)>-1:e._q(e.user_perms[t.user_id],"read")},on:{change:[function(i){var s=e.user_perms[t.user_id],r=i.target,n=r.checked?"read":"none";if(Array.isArray(s)){var o=null,a=e._i(s,o);r.checked?a<0&&e.$set(e.user_perms,t.user_id,s.concat([o])):a>-1&&e.$set(e.user_perms,t.user_id,s.slice(0,a).concat(s.slice(a+1)))}else e.$set(e.user_perms,t.user_id,n)},e.updateToggleStatus]}})]),i("td",{staticClass:"perm"}),i("td",[i("label",{attrs:{for:t.user_id+"_read"}},[e._v(" "+e._s(t.firstname)+" "+e._s(t.lastname)+" "),i("i",[e._v(e._s(t.username))])])])])})),0)]):e._e()]),i("footer",{staticClass:"modal-footer"},[e._t("footer",[i("button",{staticClass:"button accept",attrs:{type:"button"},on:{click:e.set}},[e._v(" "+e._s(e.$t("message.ButtonLabelSave"))+" ")]),i("button",{staticClass:"button cancel",attrs:{type:"button"},on:{click:e.close}},[e._v(" "+e._s(e.$t("message.ButtonLabelClose"))+" ")])])],2)])])])],1):e._e()},N=[],M=(i("e125"),i("bd86"));function z(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function F(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?z(Object(i),!0).forEach((function(t){Object(M["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):z(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var G={name:"StudentsPermissionsDialog",props:{DialogVisible:Boolean,element:Object},data:function(){return{visible:this.DialogVisible,currentElement:this.element,users:this.$store.state.courseUsers,user_perms:{},settings:{defaultRead:!0,caption_autor:"Studierende",caption_user:"Leser/innen"},toggled:{autor:{read:!1,write:!1},user:{read:!0}}}},computed:{autor_members:function(){if(0===Object.keys(this.users).length&&this.users.constructor===Object)return[];var e=this.users.filter((function(e){return"autor"==e.perm}));return e},user_members:function(){if(0===Object.keys(this.users).length&&this.users.constructor===Object)return[];var e=this.users.filter((function(e){return"user"==e.perm}));return e}},methods:{close:function(){this.deleting||this.$emit("close")},set:function(){var e=this,t=this.element.id,i={users:this.user_perms,settings:this.settings};P.a.post("set_element_approval_list",{bid:t,list:JSON.stringify(i)}).then((function(t){e.$emit("close")})).catch((function(t){console.log(t),e.$emit("close")}))},getApprovalList:function(){var e=this.element.id,t=this;P.a.post("get_element_approval_list",{bid:e,type:"users"}).then((function(e){t.users=t.$store.state.courseUsers,null!=e.data&&(void 0!==e.data.users&&(t.user_perms=e.data.users),void 0!==e.data.settings&&(t.settings=e.data.settings))})).catch((function(e){console.log(e)}))},toggleAll:function(e,t){var i,s=this.toggled[e][t],r=F({},this.user_perms);for(var n in"autor"===e?(i=this.autor_members,"write"==t?this.toggled.autor.read=!1:this.toggled.autor.write=!1):i=this.user_members,i)r[i[n].user_id]=s?t:"none";this.user_perms=r},updateToggleStatus:function(){for(var e in this.toggled.autor.read=!0,this.toggled.autor.write=!0,this.toggled.user.read=!0,this.autor_members)"read"!==this.user_perms[this.autor_members[e].user_id]&&(this.toggled.autor.read=!1),"write"!==this.user_perms[this.autor_members[e].user_id]&&(this.toggled.autor.write=!1);for(var t in this.user_members)"read"!==this.user_perms[this.user_members[t].user_id]&&(this.toggled.user.read=!1)}},watch:{DialogVisible:function(){this.visible=this.DialogVisible,this.users=[],this.visible?this.getApprovalList():(this.user_perms={},this.settings={defaultRead:!0})},autor_members:function(){var e=F({},this.user_perms);for(var t in this.autor_members)void 0===this.user_perms[this.autor_members[t].user_id]&&(this.settings.defaultRead?e[this.autor_members[t].user_id]="read":e[this.autor_members[t].user_id]="none");this.user_perms=e,this.updateToggleStatus()},user_members:function(){var e=F({},this.user_perms);for(var t in this.user_members)void 0===this.user_perms[this.user_members[t].user_id]&&(this.settings.defaultRead?e[this.user_members[t].user_id]="read":e[this.user_members[t].user_id]="none");this.user_perms=e,this.updateToggleStatus()},user_perms:function(){this.updateToggleStatus()}}},H=G,W=Object(C["a"])(H,V,N,!1,null,null,null),J=W.exports,Z=function(){var e=this,t=e.$createElement,i=e._self._c||t;return this.visible?i("div",{staticClass:"cw-dialog"},[i("transition",{attrs:{name:"modal-fade"}},[i("div",{staticClass:"modal-backdrop"},[i("div",{staticClass:"modal cw-permission-modal",attrs:{role:"dialog"}},[i("header",{ref:"modalHeader",staticClass:"modal-header"},[e._t("header",[e._v(" "+e._s(e.$t("message.setGroupsPermissions"))+" "),i("span",{staticClass:"modal-close-button",on:{click:e.close}})])],2),i("section",{staticClass:"modal-body"},[e.groups.length?i("table",{staticClass:"default groups-permissions-list"},[i("colgroup",[i("col",{attrs:{width:"20%"}}),i("col",{attrs:{width:"35%"}}),i("col",{attrs:{width:"45%"}})]),i("thead",[i("tr",[i("th",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.toggled.read,expression:"toggled.read"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.toggled.read)?e._i(e.toggled.read,null)>-1:e.toggled.read},on:{change:[function(t){var i=e.toggled.read,s=t.target,r=!!s.checked;if(Array.isArray(i)){var n=null,o=e._i(i,n);s.checked?o<0&&e.$set(e.toggled,"read",i.concat([n])):o>-1&&e.$set(e.toggled,"read",i.slice(0,o).concat(i.slice(o+1)))}else e.$set(e.toggled,"read",r)},function(t){return e.toggleAll("read")}]}}),e._v(" "+e._s(e.$t("message.readPerms"))+" ")]),i("th",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.toggled.write,expression:"toggled.write"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.toggled.write)?e._i(e.toggled.write,null)>-1:e.toggled.write},on:{change:[function(t){var i=e.toggled.write,s=t.target,r=!!s.checked;if(Array.isArray(i)){var n=null,o=e._i(i,n);s.checked?o<0&&e.$set(e.toggled,"write",i.concat([n])):o>-1&&e.$set(e.toggled,"write",i.slice(0,o).concat(i.slice(o+1)))}else e.$set(e.toggled,"write",r)},function(t){return e.toggleAll("write")}]}}),e._v(" "+e._s(e.$t("message.readWritePerms"))+" ")]),i("th",[e._v(e._s(e.$t("message.groupname")))])])]),i("tbody",e._l(e.groups,(function(t){return i("tr",{key:t.id},[i("td",{staticClass:"perm"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.perms[t.id],expression:"perms[group.id]"}],attrs:{type:"checkbox",id:t.id+"_read","true-value":"read","false-value":"none"},domProps:{checked:Array.isArray(e.perms[t.id])?e._i(e.perms[t.id],null)>-1:e._q(e.perms[t.id],"read")},on:{change:[function(i){var s=e.perms[t.id],r=i.target,n=r.checked?"read":"none";if(Array.isArray(s)){var o=null,a=e._i(s,o);r.checked?a<0&&e.$set(e.perms,t.id,s.concat([o])):a>-1&&e.$set(e.perms,t.id,s.slice(0,a).concat(s.slice(a+1)))}else e.$set(e.perms,t.id,n)},e.updateToggleStatus]}})]),i("td",{staticClass:"perm"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.perms[t.id],expression:"perms[group.id]"}],attrs:{type:"checkbox","true-value":"write","false-value":"none"},domProps:{checked:Array.isArray(e.perms[t.id])?e._i(e.perms[t.id],null)>-1:e._q(e.perms[t.id],"write")},on:{change:[function(i){var s=e.perms[t.id],r=i.target,n=r.checked?"write":"none";if(Array.isArray(s)){var o=null,a=e._i(s,o);r.checked?a<0&&e.$set(e.perms,t.id,s.concat([o])):a>-1&&e.$set(e.perms,t.id,s.slice(0,a).concat(s.slice(a+1)))}else e.$set(e.perms,t.id,n)},e.updateToggleStatus]}})]),i("td",[i("label",{attrs:{for:t.id+"_read"}},[e._v(" "+e._s(t.name)+" ")])])])})),0)]):i("span",[e._v(" "+e._s(e.$t("message.noGroupsInSeminar"))+" ")])]),i("footer",{staticClass:"modal-footer"},[e._t("footer",[i("button",{staticClass:"button accept",attrs:{type:"button"},on:{click:e.set}},[e._v(" "+e._s(e.$t("message.ButtonLabelSave"))+" ")]),i("button",{staticClass:"button cancel",attrs:{type:"button"},on:{click:e.close}},[e._v(" "+e._s(e.$t("message.ButtonLabelClose"))+" ")])])],2)])])])],1):e._e()},K=[];function q(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function Y(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?q(Object(i),!0).forEach((function(t){Object(M["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):q(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Q={name:"GroupsPermissionsDialog",props:{DialogVisible:Boolean,element:Object},data:function(){return{visible:this.DialogVisible,currentElement:this.element,groups:this.$store.state.courseGroups,perms:{},toggled:{read:!1,write:!1}}},methods:{close:function(){this.deleting||this.$emit("close")},set:function(){var e=this,t=this.element.id,i={};i.groups=this.perms,P.a.post("set_element_approval_list",{bid:t,list:JSON.stringify(i)}).then((function(t){e.$emit("close")})).catch((function(t){console.log(t),e.$emit("close")}))},getApprovalList:function(){var e=this,t=this.element.id,i=this;P.a.post("get_element_approval_list",{bid:t,type:"groups"}).then((function(t){if(i.groups=i.$store.state.courseGroups,null!==t.data&&void 0!==t.data.groups)i.perms=t.data.groups;else for(var s in i.groups)i.perms[e.groups[s].id]="none"})).catch((function(e){console.log(e)}))},toggleAll:function(e){var t=this.toggled[e],i=Y({},this.perms),s=this.groups;for(var r in"write"==e?this.toggled.read=!1:this.toggled.write=!1,s)i[s[r].id]=t?e:"none";this.perms=i},updateToggleStatus:function(){for(var e in this.toggled.read=!0,this.toggled.write=!0,this.groups)"read"!==this.perms[this.groups[e].id]&&(this.toggled.read=!1),"write"!==this.perms[this.groups[e].id]&&(this.toggled.write=!1)}},watch:{DialogVisible:function(){this.visible=this.DialogVisible,this.groups=[],this.visible?this.getApprovalList():this.perms={}}}},X=Q,ee=Object(C["a"])(X,Z,K,!1,null,null,null),te=ee.exports,ie={props:{buttons:Array,element:Object},components:{RemoveDialog:y,EditDialog:O,AddChildDialog:j,StudentsPermissionsDialog:J,GroupsPermissionsDialog:te},data:function(){return{edit_button:!1,remove_button:!1,groups_button:!1,users_button:!1,add_child_button:!1,removeDialogVisible:!1,editDialogVisible:!1,addChildDialogVisible:!1,setStudentsPermissionsDialogVisible:!1,setGroupsPermissionsDialogVisible:!1}},created:function(){var e=this;this.buttons.forEach((function(t){switch(t){case"edit":e.edit_button=!0;break;case"remove":e.remove_button=!0;break;case"add-child":e.add_child_button=!0;break;case"groups":e.groups_button=!0;break;case"users":e.users_button=!0;break}}))},methods:{editDialogAction:function(e){this.$emit("edit",e)},addChildDialogAction:function(e){this.$emit("add-child",e)},setStudentsPermissionsAction:function(e){this.$emit("set-students-permissions",e)},setGroupsPermissionsAction:function(e){this.$emit("set-groups-permissions",e)}}},se=ie,re=Object(C["a"])(se,p,g,!1,null,null,null),ne=re.exports,oe={name:"BlockItem",data:function(){return{id:this.block.id,preview:"",unfolded:!1}},components:{ActionMenuItem:ne},props:{block:Object,importContent:Boolean,remoteContent:Boolean},created:function(){this.preview=this.block.preview},watch:{block:function(){this.id=this.block.id}},methods:{removeElement:function(){this.$emit("remove-block",this.block)},toggleContent:function(){this.unfolded=!this.unfolded}}},ae=oe,le=Object(C["a"])(ae,m,h,!1,null,null,null),ce=le.exports,de={methods:{cutTitle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return e.length>t?e.substr(0,t-1)+"â€¦":e},getReadableDate:function(e){var t=new Date(e);return("0"+t.getDate()).slice(-2)+"."+("0"+(t.getMonth()+1)).slice(-2)+"."+t.getFullYear()},getContent:function(e,t){var i={};switch(e.getAttribute("type")){case"AssortBlock":return"";case"AudioBlock":var s=e.getAttribute("audio:audio_file_name"),r=e.getAttribute("audio:audio_id");if(""!=r){var n=this.getAudioBlob(t,s);return"<p>"+s+'</p><audio controls width="100%"><source src="'+n+'"/></audio>'}return"<p>"+s+'</p><audio controls width="100%"><source src="'+s+'"/></audio>';case"AudioGalleryBlock":return"";case"BeforeAfterBlock":if(i=JSON.parse(e.getAttribute("beforeafter:ba_before")),"url"==i.source)return i.url;var o=new Image;return o.src=this.getImageBlob(t,i.file_name),o.outerHTML;case"BlubberBlock":return"";case"CanvasBlock":return i=JSON.parse(e.getAttribute("canvas:canvas_content")),"web"==i.source?i.image_url:"cw"==i.source?i.image_name:"";case"ChartBlock":return e.getAttribute("chart:chart_type");case"CodeBlock":return this.escapeHtml(e.getAttribute("code:code_content"));case"ConfirmBlock":return e.getAttribute("title");case"DateBlock":return i=JSON.parse(e.getAttribute("date:date_content")),i.date+" "+i.time;case"DialogCardsBlock":return i=JSON.parse(e.getAttribute("dialogcards:dialogcards_content")),i[0].front_img_file_name;case"DiscussionBlock":return"";case"EmbedBlock":return e.getAttribute("embed:embed_source")+" "+e.getAttribute("embed:embed_url");case"FolderBlock":return"";case"ForumBlock":return"";case"GalleryBlock":return e.getAttribute("gallery:gallery_folder_name");case"HtmlBlock":return this.escapeHtml(e.textContent);case"IFrameBlock":return e.getAttribute("iframe:url");case"ImageMapBlock":var a=JSON.parse(e.getAttribute("imagemap:image_map_content")).image_name;o=new Image;return o.src=this.getImageBlob(t,a),o.outerHTML;case"InteractiveVideoBlock":var l=this.getVideoBlob(t,JSON.parse(e.getAttribute("interactivevideo:iav_source")).file_name);return'<video controls width="100%"><source src="'+l+'"/></video>';case"KeyPointBlock":return this.escapeHtml(e.getAttribute("keypoint:keypoint_content"));case"LinkBlock":return e.getAttribute("link:link_target");case"OpenCastBlock":return"";case"PdfBlock":return e.getAttribute("pdf:pdf_filename");case"PostBlock":return"";case"SearchBlock":return"";case"TestBlock":var c=e.getAttribute("test:xml"),d=new DOMParser,u=d.parseFromString(c,"text/xml");return u.firstElementChild.children[0].textContent;case"TypewriterBlock":return i=JSON.parse(e.getAttribute("typewriter:typewriter_json")),this.escapeHtml(i.content);case"VideoBlock":if(""!=e.getAttribute("video:webvideo")){if(i=JSON.parse(e.getAttribute("video:webvideo"))[0],"url"==i.source)return i.src;l=this.getVideoBlob(t,i.file_name);return'<video controls width="100%"><source src="'+l+'"/></video>'}return e.getAttribute("video:url");default:return""}},getImageBlob:function(e,t){var i=Object.keys(e.files),s="";return i.forEach((function(i,r){i.indexOf(t)>-1&&(i.indexOf("png")>-1?s=e.extractAsBlobUrl(i,"image/png"):i.indexOf("gif")>-1?s=e.extractAsBlobUrl(i,"image/gif"):(i.indexOf("jpg")>-1||i.indexOf("jpeg")>-1)&&(s=e.extractAsBlobUrl(i,"image/jpeg")))})),s},getVideoBlob:function(e,t){var i=Object.keys(e.files),s="";return i.forEach((function(i,r){i.indexOf(t)>-1&&(i.indexOf("mp4")>-1?s=e.extractAsBlobUrl(i,"video/mp4"):i.indexOf("ogg")>-1?s=e.extractAsBlobUrl(i,"video/ogg"):i.indexOf("webm")>-1?s=e.extractAsBlobUrl(i,"video/webm"):(i.indexOf("mpg")>-1||i.indexOf("mpeg")>-1||i.indexOf("mpe")>-1)&&(s=e.extractAsBlobUrl(i,"video/mpeg")))})),s},getAudioBlob:function(e,t){var i=Object.keys(e.files),s="";return i.forEach((function(i,r){i.indexOf(t)>-1&&(i.indexOf("mp3")>-1?s=e.extractAsBlobUrl(i,"audio/mpeg"):i.indexOf("mp4")>-1?s=e.extractAsBlobUrl(i,"audio/mp4"):i.indexOf("ogg")>-1?s=e.extractAsBlobUrl(s,"audio/ogg"):i.indexOf("wav")>-1&&(s=e.extractAsBlobUrl(s,"audio/wav")))})),s},escapeHtml:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,(function(e){return t[e]}))}}},ue=i("b76a"),me=i.n(ue),he={name:"SectionItem",mixins:[de],data:function(){return{id:this.element.id,title:this.element.title,shortTitle:this.element.shortTitle,unfolded:!1,blocks:this.element.children,blockList:{},draggableGroup:{name:"blocks"}}},components:{BlockItem:ce,ActionMenuItem:ne,draggable:me.a},props:{element:Object,importContent:Boolean,remoteContent:Boolean,storeLock:Boolean},created:function(){null==this.blocks&&(this.blocks=[]),this.importContent&&(this.draggableGroup={name:"blocks",pull:"clone",put:!1}),this.shortTitle=this.cutTitle(this.element.title,30)},watch:{element:function(){null==this.element.children?this.blocks=[]:this.blocks=this.element.children}},methods:{sortBlocks:function(){var e=this,t={},i=[],s=[];this.blocks.forEach((function(t){t.isRemote?(s.push("remote_"+t.id),e.$emit("isRemote")):t.isImport?(s.push("import_"+t.id),e.$emit("isImport")):s.push(t.id)})),i[this.id]=s,t.list=i,t.type="block",this.$emit("listUpdate",t)},removeBlock:function(e){var t=[];this.blocks.forEach((function(i){i.id!=e.id&&t.push(i)})),this.blocks=t},isRemoteAction:function(){this.$emit("isRemote")},removeElement:function(){this.$emit("remove-section",this.element)},editSection:function(e){this.title=e.title,this.shortTitle=this.cutTitle(e.title,30)},toggleContent:function(){this.unfolded=!this.unfolded}},computed:{dragOptions:function(){return this.importContent?{animation:200,disabled:this.storeLock,sort:!1,ghostClass:"ghost"}:{animation:200,disabled:this.storeLock,ghostClass:"ghost"}}}},pe=he,ge=Object(C["a"])(pe,d,u,!1,null,null,null),be=ge.exports,_e={name:"SubchapterItem",mixins:[de],data:function(){return{id:this.element.id,publication_date:this.element.publication_date,publication_date_readable:this.getReadableDate(this.element.publication_date),withdraw_date:this.element.withdraw_date,withdraw_date_readable:this.getReadableDate(this.element.withdraw_date),isPublished:this.element.isPublished,title:this.element.title,shortTitle:this.element.shortTitle,unfolded:!1,sections:this.element.children,sectionList:{},draggableGroup:{name:"sections"}}},components:{SectionItem:be,ActionMenuItem:ne,draggable:me.a},props:{element:Object,importContent:Boolean,remoteContent:Boolean,storeLock:Boolean},created:function(){null==this.sections&&(this.sections=[]),this.importContent&&(this.draggableGroup={name:"sections",pull:"clone",put:!1}),this.shortTitle=this.cutTitle(this.element.title,30)},watch:{element:function(){null==this.element.children?this.sections=[]:this.sections=this.element.children}},methods:{sortSections:function(){var e=this,t={},i=[],s=[],r=!1;this.sections.forEach((function(t){t.isRemote?(s.push("remote_"+t.id),e.isRemoteAction(),null!=t.children&&(r=!0,e.buildChildrenList(t,"remote_"))):t.isImport?(s.push("import_"+t.id),e.isImportAction(),null!=t.children.length&&(r=!0,e.buildChildrenList(t,"import_"))):s.push(t.id)})),i[this.id]=s,t.list=i,t.hasChildren=r,t.type="section",this.$emit("listUpdate",t)},buildChildrenList:function(e,t){var i=this,s=[],r=[],n={},o=!1;e.children.forEach((function(e){s.push(t+e.id),null!=e.children&&(o=!0,i.buildChildrenList(e,t))})),r[t+e.id]=s,n.list=r,n.hasChildren=o,"section"==e.type.toLowerCase()?(n.type="block",this.$emit("listUpdate",n)):(n.type=e.children[0].type.toLowerCase(),this.$emit("listUpdate",n))},updateList:function(e){this.$emit("listUpdate",e)},isRemoteAction:function(){this.$emit("isRemote")},isImportAction:function(){this.$emit("isImport")},removeElement:function(){this.$emit("remove-subchapter",this.element)},editElement:function(e){this.title=e.title,this.shortTitle=this.cutTitle(e.title),this.publication_date=1e3*e.publication_date,this.publication_date_readable=e.publication_date_readable,this.withdraw_date=1e3*e.withdraw_date,this.withdraw_date_readable=e.withdraw_date_readable,this.isPublished=e.isPublished},addChild:function(e){this.sections.push(e)},removeSection:function(e){var t=[];this.sections.forEach((function(i){i.id!=e.id&&t.push(i)})),this.sections=t},toggleContent:function(){this.unfolded=!this.unfolded}},computed:{dragOptions:function(){return this.importContent?{animation:200,disabled:this.storeLock,sort:!1,ghostClass:"ghost"}:{animation:200,disabled:this.storeLock,ghostClass:"ghost"}}}},fe=_e,ve=Object(C["a"])(fe,l,c,!1,null,null,null),we=ve.exports,Ce={name:"ChapterItem",mixins:[de],props:{element:Object,importContent:Boolean,remoteContent:Boolean,storeLock:Boolean},data:function(){return{id:this.element.id,publication_date:this.element.publication_date,publication_date_readable:this.getReadableDate(this.element.publication_date),withdraw_date:this.element.withdraw_date,withdraw_date_readable:this.getReadableDate(this.element.withdraw_date),isPublished:this.element.isPublished,title:this.element.title,shortTitle:this.cutTitle(this.element.title,30),unfolded:!1,subchapters:this.element.children,subchapterList:[],draggableGroup:{name:"subchapters"}}},components:{SubchapterItem:we,ActionMenuItem:ne,draggable:me.a},created:function(){null==this.subchapters&&(this.subchapters=[]),this.importContent&&(this.draggableGroup={name:"subchapters",pull:"clone",put:!1})},watch:{element:function(){null==this.element.children?this.subchapters=[]:this.subchapters=this.element.children}},methods:{sortSubchapters:function(){var e=this,t={},i=[],s=[],r=!1;this.subchapters.forEach((function(t){t.isRemote?(s.push("remote_"+t.id),e.isRemoteAction(),null!=t.children&&(r=!0,e.buildChildrenList(t,"remote_"))):t.isImport?(s.push("import_"+t.id),e.isImportAction(),null!=t.children&&(r=!0,e.buildChildrenList(t,"import_"))):s.push(t.id)})),i[this.id]=s,t.list=i,t.hasChildren=r,t.type="subchapter",this.$emit("listUpdate",t)},buildChildrenList:function(e,t){var i=this,s=[],r=[],n={},o=!1;e.children.forEach((function(e){s.push(t+e.id),null!=e.children&&(o=!0,i.buildChildrenList(e,t))})),r[t+e.id]=s,n.list=r,n.hasChildren=o,"section"==e.type.toLowerCase()?(n.type="block",this.$emit("listUpdate",n)):(n.type=e.children[0].type.toLowerCase(),this.$emit("listUpdate",n))},isRemoteAction:function(){this.$emit("isRemote")},isImportAction:function(){this.$emit("isImport")},updateList:function(e){this.$emit("listUpdate",e)},removeElement:function(){this.$emit("remove-chapter",this.element)},editElement:function(e){this.title=e.title,this.shortTitle=this.cutTitle(e.title),this.publication_date=1e3*e.publication_date,this.publication_date_readable=e.publication_date_readable,this.withdraw_date=1e3*e.withdraw_date,this.withdraw_date_readable=e.withdraw_date_readable,this.isPublished=e.isPublished},addChild:function(e){this.subchapters.push(e)},removeSubchapter:function(e){var t=[];this.subchapters.forEach((function(i){i.id!=e.id&&t.push(i)})),this.subchapters=t},toggleContent:function(){this.unfolded=!this.unfolded}},computed:{dragOptions:function(){return this.importContent?{animation:200,disabled:this.storeLock,sort:!1,ghostClass:"ghost"}:{animation:200,disabled:this.storeLock,ghostClass:"ghost"}}}},ke=Ce,ye=Object(C["a"])(ke,o,a,!1,null,null,null),Ae=ye.exports,Ee=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",{staticClass:"semester-item"},[i("p",{staticClass:"semester-description",class:{unfolded:e.unfolded},on:{click:e.toggleList}},[e._v(" "+e._s(e.semester_name)+" ")]),e.unfolded?i("ul",{staticClass:"course-list"},e._l(e.courses,(function(t){return i("CourseItem",{key:t.id,attrs:{course:t},on:{"course-selected":e.courseSelected}})})),1):e._e()])},xe=[],$e=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",{staticClass:"course-item"},[i("button",{staticClass:"blockmanager-course-item",attrs:{"data-remote_cid":e.course.id,"data-remote_name":e.course.name},on:{click:function(t){return e.$emit("course-selected",{remoteName:e.course.name,remoteId:e.course.id})}}},[e._v(" "+e._s(e.course.name)+" ")])])},De=[],Se={name:"CourseItem",data:function(){return{}},components:{},props:{course:Object},methods:{}},Oe=Se,Be=Object(C["a"])(Oe,$e,De,!1,null,"991941d8",null),Le=Be.exports,Ie={name:"SemesterItem",components:{CourseItem:Le},props:{courses:Array,semester_name:String},data:function(){return{unfolded:!1}},methods:{courseSelected:function(e){this.$emit("course-selected",e)},toggleList:function(){this.unfolded=!this.unfolded}}},Pe=Ie,Te=Object(C["a"])(Pe,Ee,xe,!1,null,"62099320",null),Re=Te.exports,Ue=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"helpbox"},[i("h2",{staticClass:"helpbox-title",class:{unfolded:e.unfolded},on:{click:function(t){e.unfolded=!e.unfolded}}},[e._v(" "+e._s(e.title)+" ")]),i("p",{directives:[{name:"show",rawName:"v-show",value:e.unfolded,expression:"unfolded"}],staticClass:"helpbox-content"},[e._v(e._s(e.content))])])},je=[],Ve={name:"HelpBox",props:{title:String,content:String},data:function(){return{unfolded:!1}}},Ne=Ve,Me=Object(C["a"])(Ne,Ue,je,!1,null,null,null),ze=Me.exports,Fe={name:"BlockManager",mixins:[de],components:{ChapterItem:Ae,SemesterItem:Re,draggable:me.a,ActionMenuItem:ne,SpringSpinner:f["a"],HelpBox:ze},data:function(){return{courseware:{},remoteCourses:{},remoteCourseware:null,importCourseware:null,showRemoteCourseware:!1,showImportCourseware:!1,showExportCourseware:!1,chapters:[],chapterList:[],subchapterList:{},sectionList:{},blockList:{},actionTitle:this.$i18n.t("message.imAndExport"),courseImportText:this.$i18n.t("message.importFromCourse"),remoteData:!1,importData:!1,importXML:"",importZIP:"",blockMap:null,fileError:!1,loading:!1,storeLock:!1,errorOccurred:[],coursewareExportURL:COURSEWARE.data.courseware_export_url,coursewareImportURL:COURSEWARE.data.courseware_import_url,coursewareExportHtmlURL:COURSEWARE.data.courseware_export_html_url,helpUnfolded:!1}},created:function(){this.courseware=JSON.parse(COURSEWARE.data.courseware),this.remoteCourses=JSON.parse(COURSEWARE.data.remote_courses),this.blockMap=JSON.parse(COURSEWARE.data.block_map)},mounted:function(){this.getCourseUsers(),this.getCourseGroups()},watch:{courseware:function(){null!=this.courseware.children?this.chapters=this.courseware.children:this.chapters=[]}},methods:{getCourseUsers:function(){var e=this;P.a.get("get_course_users",{params:{cid:COURSEWARE.config.cid}}).then((function(t){e.$store.state.courseUsers=t.data})).catch((function(e){return console.log(e),[]}))},getCourseGroups:function(){var e=this;P.a.get("get_course_groups",{params:{cid:COURSEWARE.config.cid}}).then((function(t){e.$store.state.courseGroups=t.data})).catch((function(e){return console.log(e),[]}))},sortChapters:function(){var e=this,t=!1;this.cleanLists(),this.chapters.forEach((function(i){i.isRemote?(e.chapterList.push("remote_"+i.id),e.isRemoteAction(),null!=i.children&&(t=!0,e.buildChildrenList(i,"remote_"))):i.isImport?(e.chapterList.push("import_"+i.id),e.isImportAction(),null!=i.children&&(t=!0,e.buildChildrenList(i,"import_"))):e.chapterList.push(parseInt(i.id,10))})),t||this.storeChanges()},fillChapterList:function(){var e=this;this.chapters.forEach((function(t){e.chapterList.push(t.id)}))},buildChildrenList:function(e,t){var i=this,s=[],r=!1;e.children.forEach((function(e){s.push(t+e.id),null!=e.children&&(r=!0,i.buildChildrenList(e,t))})),"section"==e.type.toLowerCase()?this.blockList[t+e.id]=s:this[e.children[0].type.toLowerCase()+"List"][t+e.id]=s,r||this.storeChanges()},isRemoteAction:function(){this.remoteData=!0,this.importData=!0},isImportAction:function(){this.remoteData=!1,this.importData=!0},updateList:function(e){var t=e.list,i=Object.keys(t)[0];this[e.type+"List"][i]=t[i],e.hasChildren||(this.fillChapterList(),this.storeChanges())},addChild:function(e){this.chapters.push(e)},removeChapter:function(e){var t=[];this.chapters.forEach((function(i){i.id!=e.id&&t.push(i)})),this.chapters=t},importFromCourse:function(){this.actionTitle=this.courseImportText,this.showRemoteCourseware=!0},showExport:function(){this.actionTitle=this.$i18n.t("message.exportButton"),this.showExportCourseware=!0},resetActionMenu:function(){this.actionTitle=this.$i18n.t("message.imAndExport"),this.fileError=!1,this.remoteCourseware=null,this.importCourseware=null,this.exportCourseware=null,this.showRemoteCourseware=!1,this.showImportCourseware=!1,this.showExportCourseware=!1},storeChanges:function(){if(!this.storeLock){this.storeLock=!0;var e=this,t=[],i={};if(e.importData&&!e.remoteData){var s=this.importZIP,r=new Promise((function(e){var t=new FileReader;t.readAsDataURL(s),t.onloadend=function(){i.file=t.result,i.name=s.name,i.size=s.size,i.type=s.type,e(t.result)}}));t.push(r)}Promise.all(t).then((function(){P.a.post("store_changes_vue",{cid:COURSEWARE.config.cid,import:e.importData,remote:e.remoteData,importXML:e.importXML,chapterList:JSON.stringify(e.chapterList),subchapterList:JSON.stringify(e.subchapterList),sectionList:JSON.stringify(e.sectionList),blockList:JSON.stringify(e.blockList),fileData:i}).then((function(t){e.importData=!1,e.remoteData=!1,e.cleanLists();try{e.courseware=JSON.parse(t.data.courseware);var i=t.data.errors;null!=i&&i.forEach((function(t){e.addError(t)}))}catch(s){console.log(s),console.log("try to reload courseware data"),e.addError(e.$i18n.t("message.error_unknown")),e.addError(e.$i18n.t("message.error_import")),P.a.post("get_courseware",{cid:COURSEWARE.config.cid}).then((function(t){e.courseware=JSON.parse(t.data.courseware),e.addError(e.$i18n.t("message.error_reload"))})).catch((function(t){t.response?(console.log(t.response.status),500==t.response.status&&e.addError(e.$i18n.t("message.error_500"))):t.request?console.log(t.request):console.log(t.message),console.log(t.config)}))}e.storeLock=!1})).catch((function(t){t.response?(console.log(t.response.status),500==t.response.status&&(e.storeLock=!1,e.addError(e.$i18n.t("message.error_500")))):t.request?console.log(t.request):console.log(t.message),console.log(t.config)}))}))}},cleanLists:function(){this.chapterList=[],this.subchapterList={},this.sectionList={},this.blockList={}},getRemoteCourse:function(e){this.loading=!0;var t=this;P.a.get("get_remote_course",{params:{cid:COURSEWARE.config.cid,remote_cid:e.remoteId}}).then((function(e){t.remoteCourseware=e.data})).then((function(){t.actionTitle="Import: "+e.remoteName,t.showRemoteCourseware=!0,t.loading=!1})).catch((function(e){console.log("there was an error: "+e.response)}))},setImport:function(){this.loading=!0;var e=this;e.fileError=!1,this.importZIP=event.target.files[0],this.showImportCourseware=!0,ZipLoader.unzip(this.importZIP).then((function(t){var i,s,r;if(void 0!=t.files["data.xml"]){i=t.extractAsText("data.xml"),s=new DOMParser,r=s.parseFromString(i,"text/xml");var n=0,o=0,a=0;e.importCourseware=[],e.importCourseware["chapters"]=[],$.each(r.documentElement.children,(function(i,s){if("chapter"==s.nodeName){n++,s.setAttribute("temp-id",n);var r=e.importCourseware["chapters"].push({title:s.getAttribute("title"),id:n,publication_date:!1,withdraw_date:!1,isPublished:!0,isImport:!0,type:s.nodeName}),l=e.importCourseware["chapters"][r-1];if("undefined"===typeof l)return!0;l.children=[],$.each(s.children,(function(i,s){if("subchapter"==s.nodeName){o++,s.setAttribute("temp-id",o);var r=l.children.push({title:s.getAttribute("title"),id:o,publication_date:!1,withdraw_date:!1,isPublished:!0,isImport:!0,type:s.nodeName}),n=l.children[r-1];if("undefined"===typeof n)return!0;n.children=[],$.each(s.children,(function(i,s){if("section"==s.nodeName){a++,s.setAttribute("temp-id",a);var r=n.children.push({title:s.getAttribute("title"),id:a,isPublished:!0,isImport:!0,type:s.nodeName}),o=n.children[r-1];if("undefined"===typeof o)return!0;o.children=[],$.each(s.children,(function(i,s){"block"==s.nodeName&&o.children.push({type:s.getAttribute("type"),id:s.getAttribute("uuid"),isPublished:!0,isImport:!0,preview:e.getContent(s,t),readable_name:e.blockMap[s.getAttribute("type")]})})),0==o.children.length&&(o.children=null)}})),0==n.children.length&&(n.children=null)}})),0==l.children.length&&(l.children=null)}}));var l=new XMLSerializer;e.importXML=l.serializeToString(r)}else e.fileError=!0})).then((function(){e.loading=!1,e.fileError||(e.showImportCourseware=!0),e.actionTitle="Import: "+e.importZIP.name+" ("+e.calcFileSize(e.importZIP.size)+")"}))},calcFileSize:function(e){return 0!=(e/1048576).toFixed(0)?(e/1048576).toFixed(1)+" MB":(e/1024).toFixed(1)+" kB"},importCompleteArchive:function(){this.storeLock=!0;var e=this,t=[],i={},s=this.importZIP,r=new Promise((function(e){var t=new FileReader;t.readAsDataURL(s),t.onloadend=function(){i.file=t.result,i.name=s.name,i.size=s.size,i.type=s.type,e(t.result)}}));t.push(r),Promise.all(t).then((function(){P.a.post("import_complete_archive",{cid:COURSEWARE.config.cid,fileData:i}).then((function(t){e.importData=!1,e.remoteData=!1,e.cleanLists(),e.courseware=JSON.parse(t.data.courseware);var i=t.data.errors;null!=i&&i.forEach((function(t){e.addError(t)})),e.storeLock=!1})).catch((function(e){console.log(e)}))}))},addError:function(e){var t=new Date,i=this.setDateZero(t.getDay())+"."+this.setDateZero(t.getMonth())+"."+t.getFullYear()+" "+this.setDateZero(t.getHours())+":"+this.setDateZero(t.getMinutes())+":"+this.setDateZero(t.getSeconds());this.errorOccurred.push({text:e,date:i})},setDateZero:function(e){return e<10?"0"+e:e},clearErrors:function(){this.errorOccurred=[]}}},Ge=Fe,He=Object(C["a"])(Ge,r,n,!1,null,null,null),We=He.exports,Je=i("2f62");s["a"].use(Je["a"]);var Ze=new Je["a"].Store({state:{courseUsers:{},courseGroups:{}}}),Ke=Ze,qe=i("a925");s["a"].use(qe["a"]);var Ye={en_GB:{message:{tasksBackButton:"back to the selection",importFromCourse:"Import from Course",importFromCourseExplain:"Import content from another event where you are a lecturer",importFromArchiveButton:"Import from Courseware archive",importFromArchiveExplain:"Upload a file that you have previously exported from a courseware",visibleFrom:"visible from",invisibleFrom:"invisible from",chapter:"Chapter",subchapter:"Subchapter",section:"Section",block:"Block",emptyChapter:"This Chapter is empty",emptyChapterInfo:"You can drop a subchapter here or add a new one",emptySubchapter:"This Subchapter is empty",emptySubchapterInfo:"You can drop a section here or add a new one",emptySection:"This Section is empty",emptySectionInfo:"You can add a Block in Courseware or drop one here",actions:"Actions",imAndExport:"Import & Export",addSubelement:"Add subelement",editElement:"Edit element",deleteElement:"Delete element",setStudentsPermissions:"Set read and write permissions for students",setGroupsPermissions:"Set read and write permissions for groups",noGroupsInSeminar:"No groups have been created for this seminar yet!",newUserReadPerms:"New users have read permissions",readPerms:"Read",readWritePerms:"Read and write",editDialogTitle:"Edit {0}",deleteDialogTitle:"Delete {0}",addDialogTitle:"Add Subelement",ButtonLabelSave:"save",ButtonLabelClose:"close",ButtonLabelYes:"yes",ButtonLabelNo:"no",title:"Title",deleteDialogQuestionBlock:"Do you really want to delete this item",deleteDialogQuestionElement:"Are you sure you want to delete this element and all its underlying elements",exportButton:"Download export archive",exportHtmlButton:"Download html export archive",exportExplain:"Select content and download it as an archive file",exportHtmlExplain:"Select content and download it as an html package",importButton:"Import from Courseware archive (old version)",importExplain:"This link leads to the old import form",exportingButton:"Export",importingButton:"Import complete archive",noRemoteCoursesAvailable:"There are no courses available for import",invalidArchiveFile:"The archive does not contain courseware data",messages:"Messages",error_unknown:"An unknown error has occurred",error_reload:"Courseware data has been reloaded",error_import:"The import of courseware data may have failed, please check the content",error_500:"The server could not process the data (500)",help:"Help",help_about_title:"Courseware Administration",help_about_content:"Under Administration, chapters, subchapters, sections and blocks can be sorted. In contrast to the editing view, in which the order of the elements can be edited, elements can be sorted into other higher-level elements here. With one click you open the element, the contained elements are displayed. Behind the three dots is the action menu, adding, deleting, editing and assigning write rights is possible here.",help_sort_title:"Sort and Move",help_sort_content:"Elements can be easily moved using drag & drop. It is also possible to move an element to another parent element. A movement is only possible on the appropriate level. It is e.g. not possible to move a section next to a subchapter.",help_approval_title:"Approvals for participants and groups",help_approval_content:"Courseware is taking another step towards collaborative learning with approvals for participants and groups. Editing blocks at the same time is not yet available, so the approval should be selected accordingly. Editing chapters and subchapters can be approved, this can be done via the action menu (on the element behind the three dots). Child elements are automatically approved. Participants can then create content and create sub-elements within the shared element. Administration, settings and discussion overview are not visible to participants.",help_add_and_delete_title:"Add and Delete",help_add_and_delete_content:"An element can be added via the action menu (hidden behind the three dots) of an element, but blocks can only be added in the edit mode of the courseware. All elements can be deleted via the action menu.",help_import_title:"Import Archive",help_import_content:'A previously exported archive can be read in via "Import from Courseware archive". After the data has been loaded, the structure of the courseware is displayed. Individual elements can be imported using drag & drop. You can import the entire content using the "Import complete archive" button. The chapters are then placed at the end of the existing content. Please note that uploading large archives can take a long time. To copy content from another event, please use "Import from event".',help_remote_import_title:"Import from Course",help_remote_import_content:'In order to import content from another course in which you are entered under the lecturers, select "Import from Course" under Import & Export. A list of semesters is displayed. Clicking on a semester shows the available courses. Select a course to display the courseware content of it. Content can be copied into the current course using drag & drop. You may have to expand the courseware elements to be able to copy elements.',help_export_title:"Export Archive",help_export_content:'A courseware archive is a zip file that contains a description of the courseware (data.xml) and all the included files. The zip file can be read in via the import in order to use content in other Stud.IP installations. To copy content from another course, please use "Import from event".',help_html_export_title:"Export HTML",help_html_export_content:"The HTML export delivers the content of Coursware and the Courseware Player. With the Courseware Player, it is possible to play the content with a browser directly from the file system of a computer. The Courseware Player can also be used on a web server. Please note that not all blocks are available in the Courseware Player. Audio gallery, confirmation, forum, bubbler, discussion & comments, search, quiz and OpenCast cannot be played at the moment. Tasks that were included in the interactive video can also not be played back.",name:"Name",groupname:"Group name"}},de_DE:{message:{tasksBackButton:"zurÃ¼ck zur Auswahl",importFromCourse:"Aus Veranstaltung importieren",importFromCourseExplain:"Importieren Sie Inhalte aus einer anderen Veranstaltung in der Sie Dozent sind",importFromArchiveButton:"Courseware-Archiv importieren",importFromArchiveExplain:"Laden Sie eine Datei hoch, die Sie zuvor aus einer Courseware exportiert haben",visibleFrom:"sichtbar ab",invisibleFrom:"unsichtbar ab",chapter:"Kapitel",subchapter:"Unterkapitel",section:"Abschnitt",block:"Block",emptyChapter:"Dieses Kapitel ist leer",emptyChapterInfo:"Sie kÃ¶nnen hier ein Unterkapitel ablegen oder ein neues hinzufÃ¼gen",emptySubchapter:"Dieses Unterkapitel ist leer",emptySubchapterInfo:"Sie kÃ¶nnen hier einen Abschnitt ablegen oder einen neuen hinzufÃ¼gen",emptySection:"Dieser Abschnitt ist leer",emptySectionInfo:"Sie kÃ¶nnen einen Block in Courseware hinzufÃ¼gen oder hier einen ablegen",actions:"Aktionen",imAndExport:"Import & Export",addSubelement:"Unterelement hinzufÃ¼gen",editElement:"Element bearbeiten",deleteElement:"Element lÃ¶schen",setStudentsPermissions:"Lese- und Schreibrechte fÃ¼r Studierende festlegen",setGroupsPermissions:"Lese- und Schreibrechte fÃ¼r Gruppen festlegen",noGroupsInSeminar:"In dieser Veranstaltung gibt es bisher keine Grupppen!",newUserReadPerms:"Neue Nutzer/-innen bekommen Leserechte",readPerms:"Lesen",readWritePerms:"Lesen und Schreiben",editDialogTitle:"{0} bearbeiten",deleteDialogTitle:"{0} lÃ¶schen",addDialogTitle:"Unterelement hinzufÃ¼gen",ButtonLabelSave:"Speichern",ButtonLabelClose:"Abbrechen",ButtonLabelYes:"Ja",ButtonLabelNo:"Nein",title:"Titel",deleteDialogQuestionBlock:"MÃ¶chten Sie dieses Element wirklich lÃ¶schen",deleteDialogQuestionElement:"MÃ¶chten Sie dieses Element und alle darunter liegenden Elemente wirklich lÃ¶schen",exportButton:"Export-Archiv herunterladen",exportHtmlButton:"Html-Export herunterladen",exportExplain:"WÃ¤hlen Sie Inhalte aus und laden diese als Archiv-Datei herunter",exportHtmlExplain:"WÃ¤hlen Sie Inhalte aus und laden diese als Html-Paket herunter",importButton:"Courseware-Archiv importieren (alte Version)",importExplain:"Dieser Link fÃ¼hrt zum alten Importformular",exportingButton:"Exportieren",importingButton:"Komplettes Archiv importieren",noRemoteCoursesAvailable:"Es sind keine Veranstaltungen fÃ¼r den Import verfÃ¼gbar",invalidArchiveFile:"Das Archiv enthÃ¤lt keine Coursewaredaten",messages:"Meldungen",error_unknown:"Ein unbekannter Fehler ist aufgetreten",error_reload:"Courseware-Daten wurden neu geladen",error_import:"Der Import von Courseware-Daten ist mÃ¶glicherweise fehlgeschlagen, bitte prÃ¼fen Sie den Inhalt",error_500:"Der Server konnte die Daten nicht verarbeiten (500)",help:"Hilfe",help_about_title:"Courseware Verwaltung",help_about_content:"Unter Verwaltung kÃ¶nnen Kapitel, Unterkapitel, Abschnitte und BlÃ¶cke sortiert werden. Im Gegensatz zum Bearbeitungsmodus, in der die Reihenfolge der Elemente bearbeitet werden kann, kÃ¶nnen hier Elemente in andere Ã¼bergeordnete Elemente einsortiert werden. Mit einem Klick Ã¶ffnen Sie das Element, die enthaltenen Elemente werden dargestellt. Hinter den drei Punkten verbirgt sich das AktionsmenÃ¼, HinzufÃ¼gen, LÃ¶schen, Bearbeiten und das Vergeben von Schreibrechten ist hier mÃ¶glich.",help_sort_title:"Sortieren und Verschieben",help_sort_content:"Elemente lassen sich einfach per Drag&Drop verschieben. Hierbei ist es auch mÃ¶glich ein Element in ein anderes Ã¼bergeordnetes Element zu verschieben. Eine Verschiebung ist immer nur auf der passenden Ebene mÃ¶glich. Es ist z.B. nicht mÃ¶glich einen Abschnitt neben ein Unterkapitel zu verschieben.",help_approval_title:"Freigaben fÃ¼r Teilnehmer*innen",help_approval_content:"Ein weiterer Schritt in Richtung kollaboratives Lernen macht Courseware mit Freigaben fÃ¼r Teilnehmer*innen und Gruppen. Ein gleichzeitiges Bearbeiten von BlÃ¶cken ist derzeit noch nicht verfÃ¼gbar, daher sollten die Freigaben entsprechend gewÃ¤hlt werden. Freigegeben werden kÃ¶nnen Kapitel und Unterkapitel, dies kann Ã¼ber das AktionsmenÃ¼ (am Element hinter den drei Punkten) geschehen. Untergeordnete Elemente werden automatisch freigegeben. Teilnehmer*innen kÃ¶nnen dann innerhalb des freigegeben Elements Inhalte erstellen und Unterelemente erzeugen. Verwaltung, Einstellungen und DiskussionsÃ¼bersicht sind fÃ¼r Teilnehmer*innen nicht sichtbar.",help_add_and_delete_title:"HinzufÃ¼gen und LÃ¶schen",help_add_and_delete_content:"Ãœber das AktionsmenÃ¼ (verbirgt sich hinter den drei Punkten) eines Elementes kÃ¶nnen Unterelemente hinzugefÃ¼gt werden, BlÃ¶cke kÃ¶nnen allerdings nur im Bearbeitungsmodus der Courseware hinzugefÃ¼gt werden. LÃ¶schen lassen sich alle Elemente Ã¼ber das AktionsmenÃ¼.",help_import_title:"Archiv importieren",help_import_content:"Ein zuvor exportiertes Archiv kann Ã¼ber Courseware-Archiv importierenâ€œ eingelesen werden. Nachdem die Daten geladen wurden wird die Struktur der Courseware dargestellt. Per Drag&Drop lassen sich einzelne Elemente importieren. Ãœber die SchaltflÃ¤che â€žKomplettes Archiv importierenâ€œ kÃ¶nnen Sie den gesamten Inhalt importieren. Die Kapitel werden dann an das Ende der bestehenden Inhalte gesetzt. Bitte beachten Sie das der Upload von groÃŸen Archiven unter UmstÃ¤nden viel Zeit in Anspruch nehmen kann. FÃ¼r das Kopieren von Inhalten aus einer anderen Veranstaltung nutzen Sie bitte â€žAus Veranstaltung importierenâ€œ.",help_remote_import_title:"Aus Veranstaltung importieren",help_remote_import_content:"Um Inhalte aus einer anderen Veranstaltung, in der Sie unter den Lehrenden eingetragen sind, zu importieren, wÃ¤hlen Sie unter Import & Export â€žAus Veranstaltung importierenâ€œ. Eine Liste von Semestern wird angezeigt. Mit einem Klick auf ein Semester werden die verfÃ¼gbaren Veranstaltungen dargestellt. WÃ¤hlen Sie eine Veranstaltung aus um sich die Courseware-Inhalte dieser Veranstaltung anzeigen zu lassen. Inhalte kÃ¶nnen per Drag&Drop in die aktuelle Veranstaltung kopiert werden. Gegebenenfalls mÃ¼ssen Sie die Elemente der Courseware aufklappen um Elemente kopieren zu kÃ¶nnen.",help_export_title:"Archiv exportieren",help_export_content:"Ein Courseware Archiv ist eine Zip-Datei die eine Beschreibung der Courseware (data.xml) sowie alle eingebundenen Dateien enthÃ¤lt. Die Zip-Datei kann Ã¼ber den Import eingelesen werden um Inhalte in anderen Stud.IP Installationen zu verwenden. FÃ¼r das Kopieren von Inhalten aus einer anderen Veranstaltung nutzen Sie bitte â€žAus Veranstaltung importierenâ€œ.",help_html_export_title:"HTML exportieren",help_html_export_content:"Der HTML Export liefert die Inhalte von Coursware sowie den Courseware Player aus. Mit dem Courseware Player ist es mÃ¶glich die Inhalte mit einem Browser direkt aus dem Dateisystem eines Rechners wiederzugeben. Der Courseware Player kann auch auf einem Webserver verwendet werden. Bitte beachten Sie das nicht alle BlÃ¶cke im Courseware Player verfÃ¼gbar sind. Audio Galerie, BestÃ¤tigung, Forum, Blubber, Diskussion & Kommentare, Suche, Quiz und OpenCast kÃ¶nnen im Moment noch nicht wiedergegeben werden. Aufgaben die im interactive Video eingebunden wurden kÃ¶nnen auch nicht wiedergegeben werden.",name:"Name",groupname:"Gruppenname"}}},Qe=new qe["a"]({locale:COURSEWARE.data.lang,messages:Ye}),Xe=Qe;s["a"].config.productionTip=!1,new s["a"]({el:"#block_mananger_content",i18n:Xe,store:Ke,render:function(e){return e(We)}})}});
//# sourceMappingURL=index.js.map